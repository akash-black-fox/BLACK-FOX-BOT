module.exports.config = {
  name: 'removeadmin',
  aliases: ['demote', 'unadmin', 'down'],
  description: 'Remove admin from a user',
  credits: 'AKASH HASAN',
  usage: 'removeadmin @user / reply',
  category: 'Group',
  groupOnly: true,
  prefix: true,
  version: "1.1.0"
};

module.exports.run = async function({ api, event, args, send, config, Users }) {
  const { threadID, senderID, mentions, messageReply } = event;
  
  const threadInfo = await api.getThreadInfo(threadID);
  const adminIDs = threadInfo.adminIDs.map(a => a.id);
  const botID = api.getCurrentUserID();
  
  if (!adminIDs.includes(botID)) {
    return send.reply(`тХнтФАтФАтФАуАМ тЪая╕П ЁЭРЦЁЭРАЁЭРСЁЭРНЁЭРИЁЭРНЁЭРЖ уАНтФАтФАтФАтХо
тФВ
тФВ тЭМ ЁЭРАЁЭРЬЁЭРЬЁЭРЮЁЭРмЁЭРм ЁЭРГЁЭРЮЁЭРзЁЭРвЁЭРЮЁЭРЭ!
тФВ
тФВ ржЖржорж┐ ржирж┐ржЬрзЗржЗ рждрзЛ ржПржбржорж┐ржи ржирж╛!
тФВ ржЖржЧрзЗ ржЖржорж╛ржХрзЗ ржкрж╛ржУрзЯрж╛рж░ ржжрзЗржиред
тФВ
тХ░тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтХп`);
  }
  
  const isGroupAdmin = adminIDs.includes(senderID);
  const isBotAdmin = config.ADMINBOT.includes(senderID);
  
  if (!isGroupAdmin && !isBotAdmin) {
    return send.reply(`тХнтФАтФАтФАуАМ ЁЯФТ ЁЭРГЁЭРДЁЭРНЁЭРИЁЭРДЁЭРГ уАНтФАтФАтФАтХо
тФВ
тФВ тЭМ ржЖрж░рзЗ ржнрж╛ржЗ ржерж╛ржорзЗржи!
тФВ
тФВ ржЕржирзНржпрзЗрж░ ржкрж╛ржУрзЯрж╛рж░ ржХржорж╛ржирзЛрж░ ржЖржЧрзЗ
тФВ ржирж┐ржЬрзЗ ржПржбржорж┐ржи рж╣рзЯрзЗ ржЖрж╕рзЗржиред ЁЯШТ
тФВ
тХ░тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтХп`);
  }
  
  let uid = '';
  
  if (messageReply) {
    uid = messageReply.senderID;
  } else if (Object.keys(mentions).length > 0) {
    uid = Object.keys(mentions)[0];
  } else if (args[0] && /^\d+$/.test(args[0])) {
    uid = args[0];
  } else {
    return send.reply(`тХнтФАтФАтФАуАМ тЪая╕П ЁЭРДЁЭРСЁЭРСЁЭРОЁЭРС уАНтФАтФАтФАтХо
тФВ
тФВ тЭМ ржХрж╛ржХрзЗ ржбрж┐ржорзЛржЯ ржХрж░ржмрзЛ?
тФВ
тФВ ЁЯСЙ ржорзЗржирж╢ржи ржХрж░рзБржи ржЕржержмрж╛
тФВ    ржорзЗрж╕рзЗржЬрзЗ рж░рж┐ржкрзНрж▓рж╛ржЗ ржжрж┐ржиред
тФВ
тХ░тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтХп`);
  }
  
  if (!adminIDs.includes(uid)) {
    return send.reply(`тХнтФАтФАтФАуАМ ЁЯе▒ ЁЭРФЁЭРТЁЭРДЁЭРЛЁЭРДЁЭРТЁЭРТ уАНтФАтФАтФАтХо
тФВ
тФВ рж╕рзЗ рждрзЛ ржПржоржирж┐рждрзЗржЗ рж╕рж╛ржзрж╛рж░ржг
тФВ ржкрзНрж░ржЬрж╛ (Member)!
тФВ
тФВ рждрж╛ржХрзЗ ржЖрж░ ржХрж┐ ржбрж┐ржорзЛржЯ ржХрж░ржмрзЛ?
тФВ
тХ░тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтХп`);
  }

  if (uid === botID) {
    return send.reply(`тХнтФАтФАтФАуАМ тЭМ ЁЭРИЁЭРМЁЭРПЁЭРОЁЭРТЁЭРТЁЭРИЁЭРБЁЭРЛЁЭРД уАНтФАтФАтФАтХо
тФВ
тФВ ржЖржорж╛ржХрзЗ ржПржбржорж┐ржи ржерзЗржХрзЗ рж╕рж░рж╛ржмрзЗржи?
тФВ ржирж┐ржЬрзЗрж░ ржкрж╛рзЯрзЗ ржХрзБрзЬрж╛рж▓ ржорж╛рж░ржЫрзЗржи!
тФВ
тХ░тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтХп`);
  }
  
  try {
    await api.changeAdminStatus(threadID, uid, false);
    
    let name = 'Unknown';
    try {
      name = await Users.getNameUser(uid);
    } catch {}
    
    return send.reply(`тХнтФАтФАтФАуАМ ЁЯФ╗ ЁЭРГЁЭРДЁЭРМЁЭРОЁЭРУЁЭРДЁЭРГ уАНтФАтФАтФАтХо
тФВ
тФВ ЁЯСд ЁЭРНЁЭРЪЁЭРжЁЭРЮ: ${name}
тФВ ЁЯЖФ ЁЭРФЁЭРИЁЭРГ : ${uid}
тФВ
тФВ ЁЯСЛ ржХрзНрж╖ржорждрж╛ рж╢рзЗрж╖! ржЖржЬ ржерзЗржХрзЗ
тФВ    рждрзБржорж┐ рж╕рж╛ржзрж╛рж░ржг ржорзЗржорзНржмрж╛рж░ред
тФВ
тФВ </> ЁЭРАЁЭРоЁЭРнЁЭРбЁЭРиЁЭРл: ЁЭРАЁЭРКЁЭРАЁЭРТЁЭРЗ ЁЭРЗЁЭРАЁЭРТЁЭРАЁЭРН
тХ░тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтХп`);
  } catch (error) {
    return send.reply(`тЭМ рж░рж┐ржорзБржн ржХрж░рждрзЗ ржкрж╛рж░рж▓рж╛ржо ржирж╛! рж╣рзЯрждрзЛ ржлрзЗрж╕ржмрзБржХрзЗрж░ рж╕ржорж╕рзНржпрж╛ред`);
  }
};